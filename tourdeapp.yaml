# $schema: https://portalbush.tourde.cloud/static/schema.json
exposedPort: 80
containers:
  - name: web
    image: registry.tourde.cloud/vznesene-cisarstvi-souhrady-a-kult-jakubovy-hory-2730/web
    port: 3001
    env:
      VITE_API_URL: https://vznesene-cisarstvi-souhrady-a-kult-jakubovy-hory-2730.tourde.app/api
    
  - name: server
    image: registry.tourde.cloud/vznesene-cisarstvi-souhrady-a-kult-jakubovy-hory-2730/server
    port: 3000
    env:
      DATABASE_URL: mysql://root:password@mysql:3306/tda_app
    
  - name: mysql
    image: mysql
    tag: "8.0"
    env:
      MYSQL_DATABASE: tda_app
      MYSQL_ROOT_PASSWORD: password
    port: 3306
  - name: caddy
    image: registry.tourde.cloud/vznesene-cisarstvi-souhrady-a-kult-jakubovy-hory-2730/caddy
    port: 80
   
build:
  - name: web
    context: ./apps/web
    dockerfile: ./apps/web/Dockerfile
  - name: server
    context: ./apps/server
    dockerfile: ./apps/server/Dockerfile
  - name: caddy
    context: ./apps/caddy
    dockerfile: ./apps/caddy/Dockerfile
